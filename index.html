<!DOCTYPE html>
<html lang="az">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Əmək Məcəlləsi - 2026 Yenilikləri</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- PDF Generation Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700;900&family=Outfit:wght@300;400;500;600;700&display=swap');
        
        * { margin: 0; padding: 0; box-sizing: border-box; }

        :root {
            /* Birbank Brand Colors */
            --birbank-red: #ED1C24;
            --birbank-gradient: linear-gradient(135deg, #ED1C24 0%, #b30000 100%);
            
            /* --- DARK MODE (Default) --- */
            --bg-body: #121212;
            --bg-gradient: linear-gradient(135deg, #0f0f0f 0%, #1a1a1a 50%, #050505 100%);
            
            --text-main: #ffffff;
            --text-secondary: #b0b0b0;
            
            /* Kartlar üçün tünd fon */
            --card-bg: #1e1e1e;
            --card-text: #ffffff;
            
            --border-color: rgba(255, 255, 255, 0.1);
            --grid-bg: rgba(255, 255, 255, 0.03);
            --footer-bg: #000000;
            --highlight-bg: rgba(237, 28, 36, 0.1);
        }

        body.light-mode {
            /* --- LIGHT MODE --- */
            --bg-body: #f4f4f4;
            --bg-gradient: linear-gradient(135deg, #ffffff 0%, #f0f2f5 100%);
            
            --text-main: #1a1a1a;
            --text-secondary: #555555;
            
            --card-bg: #ffffff;
            --card-text: #000000;
            
            --border-color: rgba(0, 0, 0, 0.08);
            --grid-bg: #fdfdfd;
            --footer-bg: #1a1a1a;
            --highlight-bg: rgba(237, 28, 36, 0.05);
        }

        body {
            font-family: 'Outfit', sans-serif;
            color: var(--text-main);
            overflow-x: hidden;
            background: var(--bg-body);
            transition: background 0.5s ease, color 0.5s ease;
        }

        /* Controls */
        .controls {
            position: fixed; top: 20px; right: 20px; z-index: 1000;
            display: flex; gap: 10px;
        }

        .control-btn {
            background: var(--birbank-gradient);
            color: #fff; border: none;
            width: 45px; height: 45px; border-radius: 12px;
            cursor: pointer; display: flex;
            align-items: center; justify-content: center;
            font-size: 18px; box-shadow: 0 5px 15px rgba(237, 28, 36, 0.3);
            transition: all 0.3s ease;
        }

        .control-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(237, 28, 36, 0.5);
        }
        
        .loading-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.8); z-index: 2000; display: none;
            align-items: center; justify-content: center; flex-direction: column;
            color: #fff;
        }
        .spinner {
            width: 50px; height: 50px; border: 5px solid #fff;
            border-top: 5px solid var(--birbank-red); border-radius: 50%;
            animation: spin 1s linear infinite; margin-bottom: 20px;
        }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

        /* Animated Background */
        #particles-canvas {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            z-index: 0; background: var(--bg-gradient);
            transition: background 0.5s ease;
        }

        /* Cover Page */
        .cover-page {
            position: relative; height: 100vh;
            display: flex; flex-direction: column;
            justify-content: center; align-items: center;
            text-align: center; z-index: 1; padding: 20px;
        }

        .cover-icon {
            font-size: 100px; color: var(--birbank-red);
            margin-bottom: 30px; animation: floatIcon 3s ease-in-out infinite;
        }

        @keyframes floatIcon {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-20px); }
        }

        .cover-title {
            font-family: 'Playfair Display', serif; font-size: 64px;
            font-weight: 900; line-height: 1.1; margin-bottom: 25px;
            color: var(--text-main);
        }

        .cover-subtitle {
            font-size: 24px; font-weight: 300; margin-bottom: 50px;
            color: var(--text-secondary); text-transform: uppercase; letter-spacing: 2px;
        }

        .cta-button {
            display: inline-flex; align-items: center; gap: 10px;
            padding: 18px 50px; font-size: 18px; font-weight: 600;
            color: #fff; background: var(--birbank-gradient);
            border: none; border-radius: 50px; cursor: pointer;
            text-decoration: none; box-shadow: 0 15px 40px rgba(237, 28, 36, 0.4);
            transition: all 0.3s;
        }
        .cta-button:hover { transform: translateY(-5px); box-shadow: 0 20px 50px rgba(237, 28, 36, 0.6); }

        /* Content */
        .main-content { position: relative; z-index: 1; padding: 80px 0; }
        .container { max-width: 1000px; margin: 0 auto; padding: 0 20px; }

        .section { margin-bottom: 60px; }
        
        .section-card {
            background: var(--card-bg); color: var(--card-text);
            border-radius: 20px; padding: 50px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            position: relative; overflow: hidden;
            transition: transform 0.3s ease;
            border: 1px solid var(--border-color);
        }
        
        /* Print/PDF Specific Optimization */
        .print-view .section-card {
            margin-bottom: 0; box-shadow: none; border: 1px solid #ddd;
        }

        .section-card::before {
            content: ''; position: absolute; top: 0; left: 0; width: 8px; height: 100%;
            background: var(--birbank-gradient);
        }

        .section-header {
            display: flex; align-items: center; gap: 20px;
            margin-bottom: 30px; padding-bottom: 20px;
            border-bottom: 2px solid var(--birbank-red);
        }

        .section-icon { font-size: 40px; color: var(--birbank-red); }
        .section-title {
            font-family: 'Playfair Display', serif; font-size: 32px;
            font-weight: 700; color: var(--card-text);
        }

        .section-content { font-size: 17px; line-height: 1.8; color: var(--text-secondary); }
        .light-mode .section-content { color: #333; }
        
        .section-content p { margin-bottom: 15px; }
        
        .section-content ul { list-style: none; padding: 0; margin-top: 15px; }
        .section-content li {
            padding: 12px 0 12px 30px; position: relative;
            border-bottom: 1px solid var(--border-color);
        }
        .section-content li:last-child { border-bottom: none; }
        .section-content li::before {
            content: '▸'; position: absolute; left: 0;
            color: var(--birbank-red); font-weight: bold; font-size: 20px;
        }

        .highlight-box {
            background: var(--highlight-bg);
            border-left: 4px solid var(--birbank-red);
            padding: 20px; margin: 20px 0;
            border-radius: 0 10px 10px 0; font-weight: 500;
            color: var(--card-text);
        }

        .grid-container {
            display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px; margin-top: 30px;
        }

        .grid-item {
            background: var(--grid-bg); padding: 30px; border-radius: 15px;
            border: 1px solid var(--border-color);
        }
        .grid-item h3 {
            color: var(--birbank-red); font-size: 22px; margin-bottom: 15px;
            font-family: 'Playfair Display', serif;
        }

        /* Footer */
        .footer {
            position: relative; z-index: 1; background: var(--footer-bg);
            padding: 40px 0; text-align: center; border-top: 2px solid var(--birbank-red);
            color: #fff; font-size: 14px;
        }

        @media (max-width: 768px) {
            .cover-title { font-size: 42px; }
            .section-card { padding: 30px 20px; }
            .section-title { font-size: 26px; }
            .section-icon { font-size: 30px; }
        }
    </style>
</head>
<body>
    
    <div class="loading-overlay" id="loader">
        <div class="spinner"></div>
        <p>PDF Hazırlanır...</p>
    </div>

    <!-- Controls -->
    <div class="controls">
        <button class="control-btn" onclick="generatePDF()" title="PDF Yüklə"><i class="fas fa-file-pdf"></i></button>
        <button class="control-btn" onclick="toggleLang()" title="Dil/Lang"><i class="fas fa-language"></i></button>
        <button class="control-btn" onclick="toggleTheme()" id="themeBtn" title="Rejim"><i class="fas fa-sun"></i></button>
    </div>

    <!-- Animated Background -->
    <canvas id="particles-canvas"></canvas>

    <!-- Content Wrapper -->
    <div id="app"></div>

    <script>
        // --- CONTENT DATA (Matching User's Provided Text) ---
        const contentData = {
            az: {
                cover: {
                    title: "Əmək Məcəlləsində Yeniliklər",
                    sub: "2026 - Yeni Tənzimləmələr",
                    btn: "Dəyişikliklərə Bax"
                },
                sections: [
                    {
                        icon: "fa-users",
                        title: "Ailə Vəzifələri olan İşçi",
                        html: `<p>Əmək Məcəlləsindəki anlayışlar sırasına <strong>"Ailə vəzifələri olan işçi"</strong> anlayışı daxil edilib. Bu anlayış qulluğa və ya köməyə ehtiyacı olan ailə üzvünə qulluq, kömək göstərilməsi ilə əlaqədar əmək fəaliyyətinə başlamaq, əmək funksiyasını yerinə yetirmək imkanları məhdud olan işçini nəzərdə tutur.</p>
                        <ul>
                            <li>Bu işçilərə əmək münasibətlərində güzəşt, imtiyaz və əlavə təminatların verilməsi ayrı-seçkilik hesab edilməyəcək.</li>
                            <li>Növbəli iş vaxtı rejimi təşkil edilərkən və gecə növbəsinə işə təyin edilərkən ailə vəzifələrinin yerinə yetirilməsi ilə əlaqədar ehtiyaclar nəzərə alınacaq.</li>
                        </ul>`
                    },
                    {
                        icon: "fa-laptop-house",
                        title: "Məsafədən (Distant) İş",
                        html: `<p>Yeni dəyişikliklərdən biri işçilər tərəfindən əmək funksiyasının elektron, proqram-texniki və s. vasitələrlə distant iş formasında yerinə yetirilməsinin hüquqi əsasının yaradılmasına xidmət edir.</p>
                        <div class="highlight-box">
                            Məcəlləyə <strong>"Məsafədən (distant) iş"</strong> anlayışı daxil edilib. Distant işlə bağlı əmək şəraitinin əlavə şərtləri tərəflərin qarşılıqlı razılığı əsasında əmək müqaviləsi ilə müəyyən olunacaq.
                        </div>`
                    },
                    {
                        icon: "fa-file-signature",
                        title: "Terminologiya və Komissiya",
                        html: `<ul>
                            <li>Qanunvericilikdə <strong>"əmək müqaviləsinin ləğv edilməsi"</strong> ifadəsi <strong>"əmək müqaviləsinə xitam verilməsi"</strong> ifadəsi ilə əvəzlənib.</li>
                            <li>Əmək və Sosial Məsələlər üzrə Üçtərəfli Komissiyanın təsis edilməsinin hüquqi əsasları gücləndirilib.</li>
                        </ul>`
                    },
                    {
                        icon: "fa-medal",
                        title: "Hərbi Xidmət",
                        html: `<p>İşçi hərbi xidmətə çağırıldıqda əmək müqaviləsinə xitam verilərkən işəgötürən tərəfindən ona <strong>orta aylıq əmək haqqının azı üç misli miqdarında müavinət</strong> ödəniləcək.</p>`
                    },
                    {
                        icon: "fa-calendar-check",
                        title: "Azı 46 Gün Məzuniyyət",
                        html: `<p>Azı 46 təqvim günü əmək məzuniyyəti verilən işçilərin sırasına aşağıdakılar daxil edilib:</p>
                        <ul>
                            <li>Ölkəmizin ərazi bütövlüyünün, müstəqilliyinin və konstitusiya quruluşunun müdafiəsi ilə bağlı təltif edilmiş işçilər;</li>
                            <li>20 Yanvar hadisələri, hərbi xidmət və Çernobıl AES ilə əlaqədar əlilliyi olan işçilər;</li>
                            <li>"Müharibə veteranı" adı almış işçilər;</li>
                            <li>Döyüş əməliyyatı aparılan ölkədə hərbi xidmət borcunu yerinə yetirmiş hərbi qulluqçu olmuş işçilər;</li>
                            <li>Azərbaycan Respublikasının ən yüksək təltifinə layiq görülmüş işçilər.</li>
                        </ul>`
                    },
                    {
                        icon: "fa-baby-carriage",
                        title: "Analıq və Atalıq",
                        html: `<div class="grid-container">
                            <div class="grid-item">
                                <h3>Analıq Məzuniyyəti</h3>
                                <p>Hamiləliyə və doğuşa görə məzuniyyətin doğuşdan əvvəlki hissəsi doğuş gözlənilən gündən uşağın doğulduğu günədək ötən günlər qədər ödənişli olaraq uzadılacaq və doğuşdan sonrakı hissə qısaldılmayacaq.</p>
                            </div>
                            <div class="grid-item">
                                <h3>Atalıq Məzuniyyəti</h3>
                                <p>Uşağının doğulması ilə əlaqədar kişilərə <strong>14 təqvim günü ödənişli məzuniyyət</strong> veriləcək.</p>
                            </div>
                        </div>`
                    },
                    {
                        icon: "fa-user-injured",
                        title: "Əmək Qabiliyyətinin İtirilməsi",
                        html: `<p>Əmək qabiliyyətini fasiləsiz olaraq <strong>altı aydan çox</strong> müddətə davamlı itirməsi ilə əlaqədar əmək funksiyasını yerinə yetirə bilməyən işçi ilə əmək müqaviləsinə (əgər iş yerinin uyğunlaşdırılması və ya yüngül işə keçirilməsi mümkün olmadıqda) xitam veriləcək.</p>`
                    },
                    {
                        icon: "fa-plane-departure",
                        title: "Ezamiyyə",
                        html: `<ul>
                            <li><strong>Əsas iş yerində</strong> ezamiyyətə gedən işçiyə əlavə iş yerində ezamiyyə müddəti qədər ödənişsiz məzuniyyət veriləcək.</li>
                            <li><strong>Əlavə iş yerində</strong> ezamiyyətə gedən işçiyə əsas iş yerində ezamiyyə müddəti qədər ödənişsiz məzuniyyət veriləcək.</li>
                        </ul>`
                    },
                    {
                        icon: "fa-hard-hat",
                        title: "Əməyin Mühafizəsi",
                        html: `<ul>
                            <li><strong>İşçi sayı 50-dən az olduqda:</strong> Əməyin mühafizəsi üzrə bilikli işçi təyin edilir və ya mütəxəssis vəzifəsi təsis edilir.</li>
                            <li><strong>İşçi sayı 50-dən çox olduqda:</strong> (Fiziki şəxs olan işəgötürənlər üçün) Əməyin mühafizəsi üzrə mühəndis vəzifəsi təsis edilir.</li>
                            <li><strong>Təlimatlandırma:</strong> Zərərli iş yerlərində <strong>3 ayda bir</strong>, digər yerlərdə <strong>ildə bir dəfədən</strong> az olmayaraq.</li>
                        </ul>`
                    },
                    {
                        icon: "fa-briefcase",
                        title: "Vakansiya və Əmək Haqqı",
                        html: `<p>İşəgötürən vakansiya yarandıqda natamam iş vaxtında çalışan işçinin tam iş vaxtında çalışması üçün tədbir görməlidir.</p>
                        <div class="highlight-box">
                            Məzuniyyətdə olduğu müddət ərzində işçinin orta əməkhaqqı <strong>sonuncu əməkhaqqından az olmamaqla</strong> saxlanılacaq.
                        </div>`
                    },
                    {
                        icon: "fa-shield-alt",
                        title: "Konfidensial Məlumatlar",
                        html: `<p>Qanunla konfidensial hesab edilən xüsusi kateqoriyalı fərdi məlumatların yayılması da işçi tərəfindən əmək vəzifələrinin kobud şəkildə pozulması hesab edilən hallar sırasına daxil edilib.</p>`
                    }
                ],
                footer: "Created by Nizami Tahir - 2026"
            },
            en: {
                cover: {
                    title: "Labor Code Innovations",
                    sub: "2026 - New Regulations",
                    btn: "View Changes"
                },
                sections: [
                    {
                        icon: "fa-users",
                        title: "Family Responsibilities",
                        html: `<p>The concept of <strong>"Employee with family responsibilities"</strong> has been introduced. This refers to employees with limited ability to perform duties due to caring for family members in need.</p>
                        <ul>
                            <li>Granting privileges to these employees will not be considered discrimination.</li>
                            <li>Family needs will be taken into account when organizing shift work and night shifts.</li>
                        </ul>`
                    },
                    {
                        icon: "fa-laptop-house",
                        title: "Remote Work",
                        html: `<p>Legal basis created for remote work performance via electronic means.</p>
                        <div class="highlight-box">
                            <strong>Remote work</strong> - work performed outside workplace using electronic/telecommunication means. Additional conditions will be determined by mutual agreement.
                        </div>`
                    },
                    {
                        icon: "fa-file-signature",
                        title: "Terminology & Commission",
                        html: `<ul>
                            <li>The term "cancellation of contract" replaced with <strong>"termination of contract"</strong>.</li>
                            <li>Legal basis for the Trilateral Commission on Labor and Social Issues strengthened.</li>
                        </ul>`
                    },
                    {
                        icon: "fa-medal",
                        title: "Military Service",
                        html: `<p>When an employee is called to military service and the contract is terminated, an allowance of <strong>at least three times the average monthly salary</strong> is guaranteed.</p>`
                    },
                    {
                        icon: "fa-calendar-check",
                        title: "Min. 46 Days Leave",
                        html: `<p>At least 46 calendar days of leave granted to:</p>
                        <ul>
                            <li>Employees awarded for defending territorial integrity;</li>
                            <li>Persons disabled due to Jan 20 events, military service, or Chernobyl;</li>
                            <li>"War Veterans";</li>
                            <li>Holders of the highest state honors.</li>
                        </ul>`
                    },
                    {
                        icon: "fa-baby-carriage",
                        title: "Maternity & Paternity",
                        html: `<div class="grid-container">
                            <div class="grid-item">
                                <h3>Maternity Leave</h3>
                                <p>Unused pre-birth leave days will be added to the post-birth period with pay, and the post-birth period will not be shortened.</p>
                            </div>
                            <div class="grid-item">
                                <h3>Paternity Leave</h3>
                                <p>Men are granted <strong>14 calendar days of paid leave</strong> upon the birth of a child.</p>
                            </div>
                        </div>`
                    },
                    {
                        icon: "fa-user-injured",
                        title: "Loss of Work Capacity",
                        html: `<p>Contract terminated if adaptation or transfer to light work is impossible after <strong>6+ months</strong> of continuous loss of work capacity.</p>`
                    },
                    {
                        icon: "fa-plane-departure",
                        title: "Business Trips",
                        html: `<ul>
                            <li><strong>Main Job Trip:</strong> Unpaid leave granted at the additional workplace.</li>
                            <li><strong>Additional Job Trip:</strong> Unpaid leave granted at the main workplace.</li>
                        </ul>`
                    },
                    {
                        icon: "fa-hard-hat",
                        title: "Labor Protection",
                        html: `<ul>
                            <li><strong><50 employees:</strong> Safety Specialist appointed.</li>
                            <li><strong>>50 employees:</strong> (For individual employers) Safety Engineer position established.</li>
                            <li><strong>Training:</strong> Every 3 months for hazardous jobs, annually for others.</li>
                        </ul>`
                    },
                    {
                        icon: "fa-briefcase",
                        title: "Vacancies & Salary",
                        html: `<p>Employers will take measures to move part-time workers to full-time when vacancies arise.</p>
                        <div class="highlight-box">
                            Average salary during leave will not be less than the employee's last salary.
                        </div>`
                    },
                    {
                        icon: "fa-shield-alt",
                        title: "Confidential Information",
                        html: `<p>Dissemination of legally confidential personal data is now considered a gross violation of labor duties.</p>`
                    }
                ],
                footer: "Created by Nizami Tahir - 2026"
            }
        };

        // State
        let currentLang = 'az';
        let isDarkMode = true;

        // Render Function
        function render() {
            const data = contentData[currentLang];
            const app = document.getElementById('app');
            
            let html = `
            <!-- Cover Page -->
            <div class="cover-page" id="pdf-cover">
                <div class="cover-icon"><i class="fas fa-briefcase"></i></div>
                <h1 class="cover-title">${data.cover.title}</h1>
                <p class="cover-subtitle">${data.cover.sub}</p>
                <a href="#content" class="cta-button">
                    <i class="fas fa-arrow-down"></i> ${data.cover.btn}
                </a>
            </div>

            <!-- Main Content -->
            <div class="main-content" id="content">
                <div class="container">`;

            // Sections
            data.sections.forEach((section, index) => {
                html += `
                <div class="section" id="pdf-section-${index}">
                    <div class="section-card">
                        <div class="section-header">
                            <div class="section-icon"><i class="fas ${section.icon}"></i></div>
                            <h2 class="section-title">${section.title}</h2>
                        </div>
                        <div class="section-content">${section.html}</div>
                    </div>
                </div>`;
            });

            html += `
                </div>
            </div>
            
            <!-- Footer -->
            <div class="footer">
                <p>${data.footer}</p>
            </div>`;

            app.innerHTML = html;
            
            // Re-attach scroll listener
            document.querySelector('.cta-button').addEventListener('click', (e) => {
                e.preventDefault();
                document.querySelector('#content').scrollIntoView({ behavior: 'smooth' });
            });
        }

        function toggleLang() {
            currentLang = currentLang === 'az' ? 'en' : 'az';
            render();
        }

        function toggleTheme() {
            isDarkMode = !isDarkMode;
            document.body.classList.toggle('light-mode');
            const btn = document.getElementById('themeBtn').querySelector('i');
            btn.className = isDarkMode ? 'fas fa-sun' : 'fas fa-moon';
            updateParticleColors();
        }

        // --- PDF GENERATION WITH VISUALS ---
        async function generatePDF() {
            const loader = document.getElementById('loader');
            loader.style.display = 'flex';

            const { jsPDF } = window.jspdf;
            const pdf = new jsPDF('p', 'mm', 'a4');
            const pageWidth = 210;
            const pageHeight = 297;
            
            // Get Elements to Print
            const cover = document.getElementById('pdf-cover');
            const sections = document.querySelectorAll('.section .section-card');
            
            // Helper function to capture element
            async function captureAndAdd(element, isNewPage = true) {
                if(isNewPage && pdf.getNumberOfPages() > 0) pdf.addPage();
                
                // Temporarily remove shadow and margin for cleaner screenshot
                const originalShadow = element.style.boxShadow;
                const originalTransform = element.style.transform;
                element.style.boxShadow = 'none';
                element.style.transform = 'none';
                
                // Increase scale for better resolution
                const canvas = await html2canvas(element, {
                    scale: 2,
                    backgroundColor: isDarkMode ? '#121212' : '#ffffff',
                    useCORS: true
                });
                
                // Restore styles
                element.style.boxShadow = originalShadow;
                element.style.transform = originalTransform;

                const imgData = canvas.toDataURL('image/png');
                const imgWidth = pageWidth - 20; // 10mm margin
                const imgHeight = (canvas.height * imgWidth) / canvas.width;
                
                // Center vertically if it's the cover, else top margin
                let yPos = 10;
                if (element === cover) {
                    yPos = (pageHeight - imgHeight) / 2;
                }
                
                pdf.addImage(imgData, 'PNG', 10, yPos, imgWidth, imgHeight);
            }

            try {
                // 1. Cover Page
                await captureAndAdd(cover, false);

                // 2. Sections (2 per page if they fit, else 1)
                for (let i = 0; i < sections.length; i++) {
                    pdf.addPage();
                    
                    // Capture specific section
                    const canvas = await html2canvas(sections[i], {
                        scale: 2,
                        backgroundColor: isDarkMode ? '#1e1e1e' : '#ffffff'
                    });
                    
                    const imgData = canvas.toDataURL('image/png');
                    const imgWidth = pageWidth - 20;
                    const imgHeight = (canvas.height * imgWidth) / canvas.width;
                    
                    pdf.addImage(imgData, 'PNG', 10, 20, imgWidth, imgHeight);
                }

                pdf.save(`Emek_Mecellesi_2026_${currentLang}.pdf`);
            } catch (err) {
                console.error("PDF Error:", err);
                alert("PDF yaradılarkən xəta baş verdi.");
            } finally {
                loader.style.display = 'none';
            }
        }

        // --- Canvas Animation ---
        const canvas = document.getElementById('particles-canvas');
        const ctx = canvas.getContext('2d');
        let particles = [];
        
        function resizeCanvas() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        }

        class Particle {
            constructor() {
                this.x = Math.random() * canvas.width;
                this.y = Math.random() * canvas.height;
                this.vx = (Math.random() - 0.5) * 0.5;
                this.vy = (Math.random() - 0.5) * 0.5;
                this.radius = Math.random() * 2 + 1;
            }
            update() {
                this.x += this.vx; this.y += this.vy;
                if (this.x < 0 || this.x > canvas.width) this.vx *= -1;
                if (this.y < 0 || this.y > canvas.height) this.vy *= -1;
            }
            draw(color) {
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.radius, 0, Math.PI * 2);
                ctx.fillStyle = color;
                ctx.fill();
            }
        }

        function initParticles() {
            particles = [];
            for (let i = 0; i < 70; i++) particles.push(new Particle());
        }

        let particleColor, lineColor;

        function updateParticleColors() {
            if(isDarkMode) {
                particleColor = 'rgba(237, 28, 36, 0.6)'; // Red
                lineColor = 'rgba(237, 28, 36,';
            } else {
                particleColor = 'rgba(237, 28, 36, 0.3)'; // Lighter Red
                lineColor = 'rgba(180, 0, 0,';
            }
        }

        function animate() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            particles.forEach(p => {
                p.update();
                p.draw(particleColor);
            });
            for (let i = 0; i < particles.length; i++) {
                for (let j = i + 1; j < particles.length; j++) {
                    const dx = particles[i].x - particles[j].x;
                    const dy = particles[i].y - particles[j].y;
                    const d = Math.sqrt(dx * dx + dy * dy);
                    if (d < 150) {
                        ctx.beginPath();
                        ctx.strokeStyle = `${lineColor} ${1 - d / 150})`;
                        ctx.lineWidth = 0.5;
                        ctx.moveTo(particles[i].x, particles[i].y);
                        ctx.lineTo(particles[j].x, particles[j].y);
                        ctx.stroke();
                    }
                }
            }
            requestAnimationFrame(animate);
        }

        window.addEventListener('resize', resizeCanvas);
        resizeCanvas();
        initParticles();
        updateParticleColors();
        animate();
        render();

    </script>
</body>
</html>
